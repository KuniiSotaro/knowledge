4-2 データの削除
==============

## 学習のポイント

* テーブルごと全て削除するには、`DROP TABLE`文を使う

* テーブル自体は残して、**行のみ** を全て削除するには`DELETE`文を使う

* 一部の行を削除する時は、`WHERE`句で対象行の条件を書く

  => `WHERE`句で削除対象行を制限した`DELETE`文を、`探索型DELETE`と呼ぶ



## DROP TABLE文とDELETE文

* データの削除方法は、以下の2種類がある

  1. `DROP TABLE`文によって、テーブルそのものを削除する

  1. `DELETE`文によって、テーブル(入れ物、容器)は残したまま、テーブルの全ての行を削除する

* `DROP TABLE`文：

  * テーブルごと全てを削除する

  * 一度削除した後にデータを再登録するには、`CREATE TABLE`文でテーブルの作成から始める必要がある

* `DELETE`文：

  * データ(行)を削除しても、テーブルは残っている

  * `INSERT`文によってすぐにデータを再登録することが可能



## DELETE文の基本構文

* `DELETE`文の基本構文は、以下の通り

```sql
DELETE FROM <テーブル名>;
```

* この構文に沿って`DELETE`文を実行すると、指定したテーブルの全ての行を削除する

* 例)Shohinテーブルを全行削除して空っぽにする

```sql
DELETE FROM Shohin;
```



## 削除対象を制限したDELETE文(探索型DELETE)

* テーブルの全行ではなく、一部の行だけを削除する場合は、`WHERE`句で条件を記述する

* `探索型DELETE`：削除対象のレコードを制限した`DELETE`文のこと

* 以下の構文で表される

```sql
DELETE FROM <テーブル名>
WHERE <条件>;
```

* 例)Shohinテーブルにおいて、販売単価(hanbai_tanka)が4000円以上の行だけを削除する

```sql
DELETE FROM Shohin
WHERE hanbai_tanka >= 4000;
```

```sql
shop=# SELECT * FROM Shohin;

shohin_id |  shohin_mei  | shohin_bunrui | hanbai_tanka | shiire_tanka |  torokubi  
-----------+--------------+---------------+--------------+--------------+------------
0001      | Tシャツ      | 衣服          |         1000 |          500 | 2009-09-20
0002      | 穴あけパンチ | 事務用品      |          500 |          320 | 2009-09-11
0004      | 包丁         | キッチン用品  |         3000 |         2800 | 2009-09-20
0006      | フォーク     | キッチン用品  |          500 |              | 2009-09-20
0007      | おろしがね   | キッチン用品  |          880 |          790 | 2008-04-28
0008      | ボールペン   | 事務用品      |          100 |              | 2009-11-11
```

* `SELECT`文とは異なり、`DELETE`文は

  * `GROUP BY`句

  * `HAVING`句

  * `ORDER BY`句

  の3種類の句は使うことができない

  => 元となるテーブルからデータを選択する時に、「抽出する形を変える」場合に使う

  => テーブルのデータそのものを削除する際には、必要がない



| 版 |   年月日  |
|----|----------|
|初版|2018/12/21|
