03 シェル変数
===========

* `シェル変数`：bash内部で使用される変数のこと

  * 数値や文字列を保存して、様々な値を設定することができる

  * bashには特別な意味を持つシェル変数が多く用意されており、これを設定することでシェルの様々な機能のカスタマイズができる



## 変数の設定

* シェル変数は、次の書式で設定する

  * 値にスペースを含む場合には、'または"で囲む必要がある

```bash
<変数名>=<値>
```

```bash
# シェル変数にvar1を設定
$ var1='test variable'
```

* 設定した変数は、先頭に`$`記号を付けて`$<変数名>`と言う形で参照できる

```bash
$ echo $var1
test variable
```

* 変数を設定する際、**=の左右にスペースを付けてはいけない**

  * スペースを入れてしまうと、変数がコマンドとみなされてしまう

```bash
$ var1 = 'test variable'
bash: var1: command not found...
```



## PS1-プロンプト設定

* シェルのプロンプト(コマンドラインの先頭に表示されている記号のこと)を変える

  => `$`で表記していた

* シェルのプロンプトを設定するには、シェル変数`PS1`に文字列を設定する

  * 設定された文字列がそのままプロンプトとして表記される

  ```bash
  $ PS1='bash> '
  bash>
  ```

  * 特別な意味を持つ記号がたくさんあり、それらの記号を`PS1`に設定するとプロンプトを表示する時にそれぞれの意味を持つ値に置き換わって表示される

    * `\u`：現在のユーザ名を意味する

    ```bash
    $ PS1='[\u]> '
    [xxx]>
    ```

    * `\w`：カレントディレクトリを意味する

    ```bash
    $ PS1='[\u] \w \$ '
    [xxx] ~ $
    [xxx] ~ $ cd /usr/local
    [xxx] /usr/local $
    ```

* 表. プロンプトで利用できる記号

| 記号 | 内容                                               |
| ---- | -------------------------------------------------- |
| `\d` | 「曜日 月 日」という形式の日付                     |
| `\h` | ホスト名のうち、最初の`.`までの部分                |
| `\H` | ホスト名                                           |
| `\n` | 改行                                               |
| `\t` | HH:MM:SS形式の現在時刻                             |
| `\u` | ユーザ名                                           |
| `\w` | カレントディレクトリ                               |
| `\W` | カレントディレクトリの末尾のディレクトリ名         |
| `\$` | rootユーザの場合は`#`、それ以外のユーザの場合は`$` |
| `\\` | `\`そのもの                                        |

* プロンプトが横に長すぎると思う場合は、`\n`を使って途中まで改行できる

```bash
$ PS1='[\u] \w (\d \t)\n\$ '
[xxx] ~ (Thu Feb 14 14:25:18)
$
```



## PATH-コマンド検索パス

* `PATH`：シェル変数

  * コマンドを実行する際にシェルがコマンドの実体のファイルを探すディレクトリを指定する

  * この変数には、**シェルがコマンドを探すディレクトリを「:」区切りで連結した文字列が設定されている**

```bash
$ echo $PATH
/usr/local/bin:/usr/local/sbin:/usr/sbin:/bin:/sbin
```

* `PATH`には、通常はディストリビューションごとに適切な値が既に設定されている

  * しかし、個別にインストールしたアプリケーションや、自分で作成した独自のディレクトリをコマンド検索パスに含めたい場合は、

    `PATH`変数の値を変更することで、コマンドをフルパスで実行する必要がなくなる

  * Linuxでは独自のコマンドを作成することができる

    => `~/bin`と言うディレクトリがよく使われる

    => 以下のコマンドを入力することで、`~/bin`の下に配置したコマンドも、フルパスを指定せずにそのまま実行できる

    ```bash
    $ PATH="$PATH:~/bin"
    ```



## LANG-ロケール

* `$LANG`：ロケールを設定する

  * 表示する言語や日付の書式などは、このロケールを基準にして切り替えられる

* `locale -a`：システムがサポートしているロケールを確認する

* 例)アメリカの英語環境を設定する

```bash
$ LANG='en_US.UTF-8'
$ cmd1
bash: cmd1: command not found...
```



## その他のシェル変数

* 表. コマンドライン履歴関連のシェル変数

| シェル変数名   | 内容                                                                    |
| -------------- | ----------------------------------------------------------------------- |
| `HISTFILE`     | コマンドライン履歴を保存するファイル名。デフォルト値は`~/.bash_history` |
| `HISTFILESIZE` | 履歴ファイルに保存するコマンドライン履歴の最大行数                      |
| `HISTSIZE`     | コマンドライン履歴を保持する最大行数                                    |

  * `HISTFILESIZE`、`HISTSIZE`のデフォルト値は500

* 表. シェルの状態関連のシェル変数

| シェル変数名 | 内容                 |
| ------------ | -------------------- |
| `HOME`       | ホームディレクトリ   |
| `SHELL`      | ログインシェルのパス |
| `PWD`        | カレントディレクトリ |

  * 例)チルダ展開の代わりに`HOME`変数を用いてホームディレクトリへのパスを書くことができる

  ```bash
  $ cd $HOME/report
  $ pwd
  /home/xxx/report
  ```



| 版 |  年/月/日 |
|----|----------|
|初版|2019/02/14|
