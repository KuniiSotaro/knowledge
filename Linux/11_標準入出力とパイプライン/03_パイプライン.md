03 パイプライン
=============

* Linuxでは、コマンドの標準出力を別のコマンドの標準入力に繋ぐ`パイプライン`という機能でコマンド連携することができる

* 例)`ls`コマンドの実行時、ファイルがたくさんあり表示結果が1画面内に収まらない場合に、結果を一旦ファイルにリダイレクトして、`less`コマンドによって閲覧する

  ```bash
  $ ls -l / > temp_list.txt
  $ less temp_list.txt
  ```

  * しかし、コマンドを実行するたびに中間ファイルを作るのはスマートではない

  => 1つのコマンドの結果を別のコマンドに直接送り込んで、コマンドを連携する(`パイプライン`)ことで対応する

* `パイプライン`は、`|`(パイプ)という記号を使って、以下のように書く

  ```bash
  <コマンド1> | <コマンド2>[| <コマンド3>]...
  ```

  * これで、1つ目のコマンドの標準出力が、2つ目のコマンドの標準入力に送り込まれている

  ![2つのコマンドラインをパイプラインで繋ぐ](./images/2つのコマンドラインをパイプラインで繋ぐ.png)

  * 例)1つ目のコマンド`ls -l /`の標準出力が、2つ目のコマンド`less`の標準入力となる

  ```bash
  $ ls -l / | less
  ```

    * `less`コマンドも`cat`コマンドと同様に、ファイルを指定しなかった場合は標準入力を入力として読み込む

    * そのため、結果として`ls`コマンドの出力を`less`コマンドで閲覧できる(コマンドの表示結果が長くなるときに、よく使われる手法)

* 例)`~/.bash_history`というファイルにあるコマンドライン履歴を、`history`コマンドで表示する

  ```bash
  $ history
   67  git status
   68  git commit -m "1章終了"
  ```

  * この履歴を、パイプラインを利用して`less`コマンドと連携することで1ページずつ閲覧できる

  ```bash
  $ history | less
  ```

* `パイプライン`は標準出力だけを次のコマンドに送る

  * 標準エラー出力もまとめて`パイプライン`に送りたいときは、`2>&1`という記法を用いて、標準エラー出力を標準出力へリダイレクトしておく

  * 例)`ls`コマンドの標準出力と標準エラー出力の両方を`less`コマンドで閲覧している

  ```bash
  $ ls -l / /xxx 2>&1 | less
  ```



| 版 |  年/月/日 |
|----|----------|
|初版|2019/03/11|
