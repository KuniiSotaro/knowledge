02 sortコマンド
==============

* `sort`コマンド：行単位でテキストをソートするコマンド

  * 「ソート」：一定の規則に基づいて行を並べること

  * デフォルトでは、辞書順(アルファベット順)に行を並べ替える

* 例)`file1`というファイルに以下のファイルが書かれているとする

  ```
  Hokkaido
  Aomori
  Iwate
  Miyagi
  Akita
  Yamagata
  Fukushima
  ```

* このファイルを`sort`コマンドでソートすると、次のようにアルファベット順で並べ替えられる

  ```bash
  $ sort file1
  Akita
  Aomori
  Fukushima
  Hokkaido
  Iwate
  Miyagi
  Yamagata

  ```

* `sort`コマンドは行の先頭から文字を比較していくが、行の途中の特定の項目を対象としてソートすることもできる

  * ここでは、`ps`コマンド(プロセス一覧を表示する)を例とする

  ```bash
  $ ps x
  PID   TT  STAT      TIME COMMAND
  307   ??  S      0:37.25 /usr/sbin/cfprefsd agent
  308   ??  S      0:03.32 /usr/libexec/UserEventAgent (Aqua)
  ```

  * この出力結果はそれぞれの項目がスペース区切りとなっており、この各項目を`フィールド`と呼ぶ

    * 例では、`PID`が第1フィールドで、`TTY`が第2フィールド

  * ここで、コマンド名(`COMMAND`)フィールドを対象として行を並び替える

  * `-k`オプション：ソートするフィールドを、フィールド番号を指定することで並び替える

    * 今回は、`COMMAND`フィールドは第5フィールドなので指定する場合には`-k 5`となる

  ```bash
  $ ps x | sort -k 5
  10313 s000  S      0:00.12 -bash
  10625 s001  S+     0:00.05 -bash
  ```

  * ただし、`sort`コマンドはASCIIコード順にソートするので、純粋に辞書順にはならない



### 数値順にソート(-n)

* `-n`オプション：文字列を数値とみなして並べ替える

  * 例)1から10までの数値がランダムに書かれたテキストファイル`number.txt`

  ```txt
  5
  6
  8
  2
  9
  10
  1
  7
  3
  4
  ```

  * このファイルを`sort`コマンドでソートすると、以下の例のように、1の次が10、その次が2となる

  ```bash
  $ sort number.txt
  1
  10
  2
  3
  4
  5
  6
  7
  8
  9
  ```

  * これは`sort`コマンドが各行を文字列として評価するため

  * 各行の値を数値として評価するための`-n`オプションをつければ、数値順にソートできる

  ```bash
  $ sort -n number.txt
  1
  2
  3
  4
  5
  6
  7
  8
  9
  10
  ```



### 逆順にソート(-r)

* `-r`オプション：逆順にソートするためのオプション

  * `sort`コマンドではデフォルトでは昇順にソートされるが、`-r`オプションを付けると降順にソートされる

  ```bash
  $ sort -r file1
  Yamagata
  Miyagi
  Iwate
  Hokkaido
  Fukushima
  Aomori
  Akita
  ```

* また、数値ソートの`-n`と逆順ソートの`-r`を組み合わせることで、 **数値データが記録されたファイルなどを値の大きい順に並べ換える** ことができる

  * 例)`ls`コマンドの結果をファイルサイズの大きい順に並べ換える

  ```bash
  $ ls -l /bin/ | sort -rn -k 5
  -r-xr-xr-x  1 root  wheel  1282864  2  5 14:28 ksh
  -r-xr-xr-x  1 root  wheel   618480  2  5 14:28 sh
  -r-xr-xr-x  1 root  wheel   618416  2  5 14:28 bash
  ```

  * `ls`コマンドの`-l`オプションでは第5フィールドにファイルサイズが表示されるので、この値でソートするように`-k 5`と指定している

  * さらに`-rn`と、逆順ソートおよび数値ソートを組み合わせることで、ファイルサイズの大きい順に表示することができる



| 版 |  年/月/日 |
|----|----------|
|初版|2019/03/11|
