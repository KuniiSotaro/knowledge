04 コマンド履歴
=============

* Linuxを使っていると、以前に実行したことのあるコマンドラインを呼び出して再び実行したいことがある

* `bash`は、一度入力したコマンドラインの内容を自動的にコマンド履歴として記録している

  * コマンド履歴を活用すれば、以前入力したコマンドをいちいち手で打ち直すことなく簡単にコマンドライン上に呼び出すことができる



## コマンド履歴の操作

* 1つ前のコマンド履歴に移動する：

  * `Ctrl`+`p`：「Previous」(前)

  * `↑`キー

* 次のコマンド履歴へ移動する：

  * `Ctrl`+`n`：「Next」(後)

  * `↓`キー

* 例)`echo`コマンドを実行しようとして、間違えて`cho`を打ち込んだ場合

  => `Ctrl`+`p`を打ち込むことで、直前の入力内容がコマンドラインに復元される

  => `Ctrl`+`a`で行頭にカーソルを移動させて`e`を打ち込むことで、正しいコマンドとなる

```bash
$ cho Hello
bash: cho: command not found...
$ cho Hello
```

|        コマンド         |             内容              |
|:----------------------|:-----------------------------|
|`Ctrl`+`p`、または`↑`キー|1つ前のコマンド履歴に移動する      |
|`Ctrl`+`n`、または`↓`キー|次のコマンド履歴へ移動する        |
|`Ctrl`+`r`             |履歴を遡ってインクリメンタル検索する|



## コマンド履歴の検索

* 多くの作業を行なった後に、`Ctrl`+`p`を何度も押すのは大変

  * `インクリメンタル検索`：逐次検索、1文字入力するごとに履歴を検索するモード

  * 検索したい語を入力することで自動的に検索される

* 履歴を遡ってインクリメンタル検索する：

  * `Ctrl`+`r`

* 例)インクリメンタル検索

```bash
(reverse-i-search)'':
```

* 例)インクリメンタル検索の状態で`e`を入力する

```bash
(reverse-i-search)'e': env
```

* 例)インクリメンタル検索の状態で`ec`を入力する

```bash
(reverse-i-search)'ec': echo Hello
```

* ここで、さらに`Ctrl`+`r`を押せば、1つ前の検索結果へ移動する

* 現在の検索結果をそのまま実行したい場合：`Enter`キー

* コマンドラインを修正して実行したい場合：`Esc`キー

|  コマンド   |                  内容                   |
|:----------|:-----------------------------------------|
|(文字の入力)|検索語を追加して再検索                        |
|`Ctrl`+`r`|1つ前の検索結果へ移動                         |
|`Enter`キー|現在の検索結果をそのまま実行                   |
|`Esc`キー  |現在の検索結果を表示したまま、コマンドラインに戻る |
|`Ctrl`+`g`|検索結果を破棄し、プロンプトに戻る               |



| 版 |  年/月/日 |
|----|----------|
|初版|2019/02/02|
