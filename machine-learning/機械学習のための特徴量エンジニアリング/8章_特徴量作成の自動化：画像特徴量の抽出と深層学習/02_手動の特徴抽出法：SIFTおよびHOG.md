02 手動の特徴抽出法：SIFTおよびHOG
==============================

* `SIFT`：画像を小部分に分割し、その統計量を用いることで、画像をよりうまく表現できる

* 画像に含まれる物体から画像にタグをつけ、されにその物体がその画像のどこに位置するかを示すことができる

* 物体の位置を検出する際は、以下の項目を行っている

  * 画像内のスケールの階層の把握

  * 物体を示す特徴点の検出

  * その特徴点によって表される特徴量(`画像記述子`)の抽出

  * 物体のオリエンテーションの決定

* `SIFT`による特徴量の抽出は、`HOG`と非常に似ている

  * いずれの手法も、本質的には勾配方向のヒストグラムの計算と言える



## 1.画像勾配

* 画像処理においては、ピクセル値をそのまま使うのではなく、ピクセルを何らかの形で「組織化」する必要がある

  * ここでは、隣接するピクセル間の差を利用する

  > `ピクセル値`：物体の境界や影があるところ、模様内、強く質感の出る場所において変化する
  >
  > `画像勾配`：`ピクセル値`間の差

* 画像勾配を計算する最も単純な方法は、隣接するピクセル間で水平方向( $`x`$ )、垂直方向( $`y`$ )の差をそれぞれ計算すること

  > この計算結果は、2次元のベクトルとして表現できる

* $`x`$ 方向および $`y`$ 方向の2つのベクトルの差の計算は、ベクトルのマスクもしくはフィルタとして表現できる

  > 例)`[1 0 -1]`フィルタ：水平方向もしくは垂直方向の隣接するピクセル値の差を計算する

* `畳み込み`：画像にフィルタをかけること

  * パッチ(画像の一部分)にフィルタをかけてその内積をとり、また別のパッチに移動して同じ作業を繰り返していく

  > `畳み込み`は、信号処理では一般的な手法
>
> $`[a b c]*[1 2 3] = c*1 + b*2 + a*3`$
>
> ピクセル $`(i,j)`$ における $`x`$ 方向と $`y`$ 方向の勾配は以下の通り
>
> $`g_x(i,j)=[1 0 -1]*[I(i-1,j) I(i,j) I(i+1,j)] = -1*I[i-1,j]+1*I[i+1,j]`$
>
> $`g_x(i,j)=[1 0 -1]*[I(i,j-1) I(i,j) I(i,j+1)] = -1*I[i,j-1]+1*I[i,j+1]`$
>
> まとめると、`勾配`は以下の通りになる
>
> $`\bigtriangledown I(i,j) = \left[\begin{array}{rrr}g_x(i,j) \\ g_y(i,j)\end{array}\right]`$

* 「勾配の大きさ」は、`ユークリッドノルム`( $`\sqrt{g_x^2+g_y^2}`$ )と等価

  * これは、ピクセルの近傍における`ピクセル値`の変化を示している

* 「勾配の方向( $`\theta`$ )」：水平方向および垂直方向の変化の比に依存する

  > $`\theta = \arctan\Bigl(\frac{g_y}{g_x}\Bigr)`$

* 以下の図に、垂直方向及び水平方向の勾配から構成される3つの画像勾配を例示した

  * それぞれの図は9つのピクセルで構成されており、各ピクセルはグレースケールの値を持っている(値が小さいほど黒に近づく)

![画像勾配の例](./images/画像勾配の例.png)

* 9つのピクセルの中心に位置するピクセルの勾配を各図の下に示した

  * 左の図：水平方向の縞模様を表しており、垂直方向のみ色の変化がある

    > 水平方向の勾配は0、垂直方向の勾配は非0となる

  * 真ん中の図：垂直方向の縞模様を示しており、水平方向の勾配は非0となる

  * 右の図：対角方向の縞模様を示しており、勾配もそれに対応した結果となる



### 実際の例
