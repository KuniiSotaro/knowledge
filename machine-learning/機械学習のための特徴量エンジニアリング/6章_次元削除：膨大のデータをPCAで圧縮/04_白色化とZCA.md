04 白色化とZCA
=============

* 主成分ベクトル同士の「直交性条件」：変換された特徴量は、お互いに相関を持たない(無相関になる)

  > 特徴ベクトル間の内積が`0`になる

* 次の得意ベクトルの直交性条件を用いて、証明が行われる

![直交性条件](https://latex.codecogs.com/gif.latex?\bm{Z^T}\bm{Z}=\bm{(\sum)_k}\bm{U_k^T}\bm{U_k(\sum)_k}=\bm{(\sum)_k^2})

* 最終的な結果は、「特異値の2乗を要素とする対角行列」

  * 特異値の2乗：各特徴ベクトルの自分自身との相関を表す

  > ![l2](https://latex.codecogs.com/gif.latex?l^2)(2乗ノルム)としても知られている

* 場合によっては、特徴量のスケールを`1`に規格化すると便利

  > これを、「白色化」と呼ぶ

  * この操作では、大きさが`1`で、相関が`0`となる特徴ベクトルの集合が得られる

  > 数学的には、特異値の逆行列を主成分分析による変換結果にかける操作と等価

![PCA+白色化](https://latex.codecogs.com/gif.latex?\bm{W_{white}}=\bm{V_k}\bm{(\sum)_k^{-1}}\\&space;\bm{Z_{white}}=\bm{X}\bm{V_k}\bm{(\sum)_k^{-1}}=\bm{U}\bm{\sum}\bm{V^T}\bm{V_k}\bm{(\sum)_k^{-1}}=\bm{U_k})

* 白色化：次元削減とは独立な操作

  * 次元削減だけ、あるいは白色化だけを実行することもできる

  > 例：`ゼロ位相成分分析`(ZCA)：PCAと密接に関連した白色化の手法、次元削減は行わない
  >
  > ![ZCAによる白色化](https://latex.codecogs.com/gif.latex?\bm{W_{ZCA}}=\bm{V}\bm{(\sum)^{-1}}\bm{V^T}\\&space;\bm{Z_{ZCA}}=\bm{X}\bm{V}\bm{(\sum)^{-1}}\bm{V^T}=\bm{U}\bm{\sum}\bm{V^T}\bm{V}\bm{(\sum)^{-1}}\bm{V^T}=\bm{U}\bm{V^T})

* `PCA`は新しい特徴量空間における座標系を生成し、主成分は基底ベクトルとしての役割を持つ

  * この座標系は射影されたベクトルの長さのみを表現しており、その方向まで表現するものではない

  * 射影されたベクトルの長さと主成分を掛け合わせることにより、長さ+方向を得る

  > 別の解釈：乗算が座標系を回転させ、元の特徴量空間での表現に戻す
  >
  > ![V](https://latex.codecogs.com/gif.latex?\bm{V})は直交行列であり、直交行列は乗算される対象の長さを変えることなく、
  >
  > その向きだけを変える機能がある

  * 従って、`ZCA`による白色化を用いることで、元データに出来るだけ(ユークリッド距離に近く)近く白色化されたデータを取得



| 版   | 年/月/日   |
| ---- | ---------- |
| 初版 | 2019/05/25 |
