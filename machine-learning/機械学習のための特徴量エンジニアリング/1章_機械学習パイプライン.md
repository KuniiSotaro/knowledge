1章 機械学習パイプライン
====================

## 1.データ

* `データ`：通常は、現実の世界で起こった現象を観測・保存したもの

  * 例)株式市場のデータ

    * 日々の株価

    * 会社の業績報告

    * 金融市場の専門家が発行する市場見通し

* 個々のデータは、ある現象の限られた一面をみることのできるツールに過ぎない

  * データを組み合わせると、その現象の全体像を見渡すことができる

  * しかし、描かれる全体像は何千という沢山の小さなデータから形成されている

    * 加えて、データ自体には測定時のノイズや欠損も付き物

    => 一見データの意味するところがわからないこともある



## 2.タスク

* データを集めることによって、答えることのできる質問がある

  * 例)「どの株に投資すれば良いか」

* データからスタートして導き出される「結果」というゴールへの道は、間違った仮説や施策によって行き詰まることが多い

* データが絡んでくるワークフローは、`ETL`やデータ分析を繰り返すプロセスから構成される

  > `ETL`：データの抽出・加工、最終的なDBへの保存を意味する

* 例)株価について

  * まず、取引所で実際に値付けされることで`株価データ`となる

  * そのデータが仲介業者によって集約された上でDBに保存される

    => 彼らの販売する商品となる

  * このDBに保存された株価データ(商品)が他の企業によって購入されると、これらのデータは購入企業のデータに残る

  * このデータは購入企業の各店舗からスクリプトによって引き出される

  * 前処理を繰り返したら、モデリング用のライブラリで使用できる形式に変換する

  * 作り上げたモデルの予測結果はCSVファイルに書き出され、その性能が評価される

    => モデリング自体を何度も繰り返すこともある

    => モデルを別言語で記述することもある

* このプロセスには、機械学習になくてはならない`モデル`、`特徴量`という2つの要素が存在している



## 3.モデル

* `誤データ`：測定時の失敗による結果を表したデータ

* `冗長データ`：全く同じ情報を意味する要素が含まれているデータ

  * 例)曜日の情報が「月曜日」以外にも、曜日を意味する「1」という数字が含まれている

* `欠損データ`：一部のデータ点において曜日の情報が存在しないデータ

* `数理モデル`：あるデータの集まりに対してデータ同士の関係性を過程し、その関係性を数式として定式化したもの

  * 例)株価を予測する：会社の業種、過去の業績・株価などが、将来の株価を予測する数式となる

* `数式`：数値として表現されている量を互いに関連付けることができる

  * しかし、生データが数値ではないケースも多々ある

  * 従って、この生データと数式を繋ぐものが必要となる

    => `特徴量`



## 4.特徴量

* `特徴量`：生データを数値として表現したもの

  * 生データを数値へと変換する方法は沢山あるので、特徴量を作るために手間暇がかかることがある

  * 当然、特徴量はその生成元のデータの型に基づいて生成されなければならない

  * 特徴量がモデル自体と結びついている

    * あるモデルがある種の特徴量により適したモデルということ、逆にあまり適していないという場合もある

* 良い特徴量は、今解いているタスクと密接に関係しており、また簡単にモデルに取り込めるものを指す

  * `特徴量エンジニアリング`：与えられたデータ、モデル、タスクに最も適した特徴量を作り上げるプロセス

* 特徴量の数も重要で、もし十分な数の有用な特徴量がなければ、モデルは解きたい問題を解くことができないかもしれない

  * 逆にもし特徴量が多過ぎたり、解きたい問題とはあまり関係のない特徴量ばかりが存在している場合には、モデルが複雑になり学習が困難になる

  * また、モデルの性能を決める学習過程で何か間違いを起こす可能性がある



## 5.モデル評価

* 特徴量とモデルは、生データと最終的な結果の間に位置する

![特徴量エンジニアリングの立ち位置](./images/特徴量エンジニアリングの立ち位置.png)

* 機械学習のワークフローにおいては、「どのモデルを使うか？」というモデルの選択のみならず特徴量の取捨選択も重要

  * この選択の過程を通じ、モデルと特徴量は相互に影響し合う

  * 良い特徴量を使うことができれば、モデリングの作業がより簡単になり、結果として得られるモデルの性能も良いものとなる
