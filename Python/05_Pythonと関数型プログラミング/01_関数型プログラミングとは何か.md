01 関数型プログラミングとは何か
==========================

* プログラミングの「命令型」、「オブジェクト指向」のようないくつかの手法

  => プログラミングの`パラダイム`と呼ぶ

  => Pythonは、複数のパラダイムを併せ持つ言語

* `関数型プログラミング`：

  * プログラミングパラダイムの一つ

  * 全てを関数で済まそうとする手法

* 例)回文を判定する

  * `オブジェクト指向`

    ```python
    >>> orig_str = "よのなかねかおかおかねかなのよ"
    >>> str_list = list(orig_str)
    >>> str_list.reverse()
    >>> "".join(str_list) == orig_str
    True
    ```

  * `関数型プログラミング`

    * `reversed()`：リストの`reverse()`メソッドに似た機能を持つ

    ```python
    >>> orig_str = "おかしがすきすきすがしかお"
    >>> "".join(reversed(orig_str)) == orig_str
    True
    ```

* 関数型の方がシンプルになる理由として、

  1. データとメソッドが一体になっているオブジェクト指向そのものが、この例では悪い方向に働いている

    => 文字列型は破壊的操作ができないため

  1. `reversed()`という関数は、処理に破壊的操作を伴わないので、どの種類でも引数として受け取ることができる

    => 結果は戻り値として返ってくる

* オブジェクトが持つデータや状態を変更したことによって起こる問題を、`副作用`と呼ぶことがある

  * 関数型がオブジェクト指向に比べてシンプルになるのは、処理に副作用が伴わないこと

  * 入力に対して出力を得るという構造でプログラムを書くことができる



## Pythonの文と式

* 関数型の手法を使うと、プログラムをシンプルにかける理由として、

  * 改行やブロックを伴わない

* Pythonでは、関数定義やループ、条件分岐を必要とするコードでは、ブロックを伴う構文で改行を求められる

  => ちょっとしたコードを書くのにも改行を含むコードを書く必要があり、コードが冗長になってしまうことがある

  => 関数型プログラミングの手法を使うと、このようなコードを改行なしで書くことができる

* `文`：関数定義のdef文、ループのfor文やwhile文、条件分岐のif文

  * 改行とインデントをしたブロックを伴う

* `式`：算術演算子や比較演算子を使った計算式、比較式をはじめとする要素を分類する用語

  * 他にも、文字列や数値のリテラル、変数、関数呼び出しも式の一部

  * 文と違って、式は改行を使わず、幾つでも並べて書くことができる



## lambda式

* `lambda式`：使い捨ての関数を定義できる

  * lambda式で定義される関数には関数名がないため、`無名関数`と呼ばれる

```python
lambda 引数のリスト:引数を使った式(戻り値)
```

* 例)ソート順の指定にlambda式を用いる

```python
>>> tank_data = [("Ⅳ号戦車", 38, 80, 75), ("LT-38", 42, 50, 37),
...              ("八九式中戦車", 20, 17, 57), ("Ⅲ号突破砲", 40, 50, 75),
...              ("M3中戦車", 39, 51, 75)]

# def evaluate_tankdata(tup):
#   return tup[1]+tup[2]+tup[3]

>>> tank_data.sort(key=lambda tup: sum(tup[1:4]), reverse=True)
>>> tank_data
[('Ⅳ号戦車', 38, 80, 75), ('Ⅲ号突破砲', 40, 50, 75),
('M3中戦車', 39, 51, 75), ('LT-38', 42, 50, 37),
('八九式中戦車', 20, 17, 57)]
```

* `lambda tup: sum(tup[1:4])`という部分が、コメントアウトしている関数と同じ処理をしているlambda式の部分

* lambda内部では、`sum()`とスライスを」使ってより短く書き直してある

  * lambda式の部分は、`sort()`メソッドのkey引数として渡されている

  * lambdaは式なので、このように関数呼び出しの内部に埋め込んで、引数として渡すことができる

* `sorted()`：`sort()`メソッドに対応する関数

  * シーケンスを引数に取ってソートした結果を返す関数

```python
>>> r = sorted(tank_data, key=lambda tup: sum(tup[1:4]), reverse=True)
>>> r
[('Ⅳ号戦車', 38, 80, 75), ('Ⅲ号突破砲', 40, 50, 75),
('M3中戦車', 39, 51, 75), ('LT-38', 42, 50, 37),
('八九式中戦車', 20, 17, 57)]
```



| 版 |  年月日   |
|---|----------|
|初版|2019/01/30|
