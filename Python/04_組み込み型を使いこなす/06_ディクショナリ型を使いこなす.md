06 ディクショナリ型を使いこなす
==========================

* ディクショナリオブジェクトを作るときは、大抵波括弧`{}`で囲んだリテラルを使った定義を利用する

* そのほかに、`dict()`という組み込みの関数を使ってディクショナリを作る方法がある

  => リストやタプルといったシーケンスを使って、ディクショナリを作ることができる



## シーケンスなどからディクショナリを作る

* `dict()`を使ってディクショナリを作る方法には、何種類かのバリエーションがある

* 以下の例では、`{'one':1, 'two':2}`というディクショナリを作る

|           dictの使い方          |                                                            説明                                                           |
|--------------------------------|--------------------------------------------------------------------------------------------------------------------------|
|   `dict({'one':1, 'two':2})`   |ディクショナリからディクショナリを作る(コピー)                                                                                    |
|`dict([['one', 1], ['two', 2]])`|キーと値からなる、2つの要素を持つシーケンスを並べたシーケンスからディクショナリを作る。既存のシーケンスからディクショナリを作る場合に利用すると便利|
|      `dict(one=1, two=2)`      |キーワード引数からディクショナリを作る。キーは必ず文字列になる。この方法では、「3=2」のように、数値を使ったキーは登録できない                  |



## 2つのディクショナリを組み合わせる

* `update()`：2つのディクショナリを組み合わせることができる

  * メソッドの引数として他のディクショナリを渡して、組み合わせるディクショナリを指定する

  * メソッド呼び出しに利用したディクショナリそのものが書き換わり、重複したキーは上書きする

```python
>>> rssitem = {"title"  :"Pythonの勉強前",
...            "link"   :"http://host.to/blog/entry",
...            "dc:date":"2016-05-16T13:24:04Z"}
>>> rssitem.update({"title"     :"Pythonを勉強中",
...                 "dc:creator":"someone"})
>>> rssitem.keys()
dict_keys(['title', 'link', 'dc:date', 'dc:creator'])
>>> rssitem
{'title': 'Pythonを勉強中', 'link': 'http://host.to/blog/entry', 'dc:date': '2016-05-16T13:24:04Z', 'dc:creator': 'someone'}
```

* `update()`メソッドの引数には、「a=1」のようなキーワードを指定することも可能

  => `dict()`関数と同じように、キーワードを文字列に見立ててキーとして登録し、ディクショナリの要素として組み合わせる



## ディクショナリのキーをスマートに使う

* ディクショナリを使った処理では、キーが存在するかどうかを気をつけて処理を行う必要がある

* キーを指定した代入を実行する場合には、キーが存在しない場合は新たに追加されるので、問題はあまり起きない

* キーを指定してディクショナリの要素を`参照`する場合は、存在しないキーを使ってディクショナリの要素を参照しようとすると、例外(KeyError)が発生する

* `get()`：引数にキーを渡して、キーに対応する値を取り出す

  * オプションの引数に、キーが存在しなかった場合に返す値(デフォルト値)を指定できる

  * 例)キーが存在しなかった場合に、0を返す

    => `line`：英文を含む1行の文字列「line」

```python
for word in line.split():
  wordcount[word] = wordcount.get(word, 0) + 1
```



## ディクショナリのメソッドを活用する

> * D：処理の対象となるディクショナリ
>
> * []内の引数はオプション(省略可)

* `keys()`：ディクショナリDに登録されているキーの一覧を返す

```python
D.keys()
```

* `get()`：ディクショナリDから、キーに割り当てられた値を取り出す

  * オプションの引数として値を与えると、Dにキーが存在しなかった場合にこの値を返す

  * 省略すると、Noneを返す(None:何もないことを表す特殊な値)

```python
D.get(キー[, 値])
```

* `setdefault()`：基本的に`get()`メソッドと同じく、第1引数に割り当てられた値を返す

  * キーが存在しなかった場合、第2引数を値とし、第1引数をキーとする要素をDに挿入する

  * 第2引数を省略すると、Noneが使用される

    => 結果的にDを改変する可能性があることに気をつける

```python
D.setdefault(キー[, 値])
```

* `items()`：ディクショナリDに登録されているキーと値をペアにしたタプルを、リストにして返す

```python
D.items()
```

* `values()`：ディクショナリDに登録されている値の一覧を返す

```python
D.values()
```

* `update()`：ディクショナリDに引数で指定した要素を追加する

  * 同名のキーがある場合は、上書きされる

  * 実際はディクショナリD自体が再作成されることになるので、要素の順番は保証されない

  * 引数には、

    * ディクショナリ

    * キーと値のシーケンスを並べたシーケンス

    * key=valueのようなキーワード

    のいずれかを取ることができる



| 版 |  年月日   |
|---|----------|
|初版|2019/01/19|
