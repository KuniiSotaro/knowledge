04 サードパーティのモジュールを使う
=============================

* 標準ライブラリ以外にも、Pythonで利用できるたくさんのライブラリやモジュールが公開されている



## モジュールの探し方

* Pythonに内蔵されている標準ライブラリは、種類も豊富でとても便利

* Anacondaのような特定用途に特化したディストリビューションには、標準ライブラリに加え、演算やビジュアライゼーションなどのライブラリが追加で付属している

* しかし、DBやAPIなどは標準化されていないことがある

  => 外部ライブラリに存在する



### PyPIでモジュールを探す

* python.orbのwebサイトでは、`PyPI`(Python Package Index)という名前のサービスを提供している

https://pypi.python.org/pypi

* `PyPI`とは、膨大な数にのぼるPythonのモジュールを集積するためのサービス

  * キーワードを使って、モジュールを検索することができる

  * 自分で作ったモジュールを公開するために、PyPIに登録することもできる

  * モジュールのバージョンごとに必要な情報を管理している

  * ダウンロード用のURLや作者の情報などを、モジュールごとに表示できる

  * モジュールごとに英文で簡単な解説が記述されている

  * モジュールが関連するジャンルがわかるように、キーワードが設定されていて、解説やキーワードに含まれる文字列を対象に検索することができる



## pipを使ってモジュールをインストールする

* `pip`を使うと、`PyPI`に登録されているモジュールを手軽にインストールできる

  => Python3.4から、`pip`は標準の外部ライブラリインストールツールとして標準ライブラリに含まれている

* `pip`のような仕組みの便利なところは、**ライブラリの依存関係** を解決すること

  * ある外部ライブラリが、別の外部ライブラリの機能を使っていることがある

  * このようにライブラリが親子のような関係を作っている関係(依存関係)を含めて、インストールする

* ライブラリのインストール

```bash
$ python -m pip install ライブラリ名
```

* ライブラリのバージョンアップ(すでにインストールされている場合)

```bash
$ python -m pip install --upgrade ライブラリ名
```



## condaを使ってモジュールをインストールする

* Anacondaに搭載されている`conda`という仕組みを使うと、本家版Pythonの`pip`ではインストールし辛い外部モジュールのうち、よく使われるものの多くをインストールできる

* `conda`を使うには、`pip`と同じくコマンドプロンプトやシェルを使う

* ライブラリの検索

```bash
$ conda search ライブラリ名
```

* ライブラリのインストール

```bash
$ conda install ライブラリ名
```

* `PyPI`に登録されているライブラリの中には、部分的にC言語で書かれているものがある

  * そのようなライブラリを`pip`でインストールするには、コンパイルする必要がある

  * コンパイルを行うソフトの設定がないと、そのようなライブラリは`pip`でインストールできない

* `conda`を使うと、あらかじめコンパイルされたファイルを利用してインストールを行える



## モジュールの種類



### Pythonだけで書かれたモジュール

* Pythonのコードだけで書かれたモジュールでは、事前にコンパイルなどを行う必要がない

* モジュールのファイル一式をダウンロードすると、大抵はそのままモジュールを利用するために設定できる



### C言語のソースコードを利用しているモジュール

* 機能の一部を実現するために、C言語で書かれたソースコードをコンパイルする必要があるモジュールもある

  => OSやアプリケーションの機能を利用するモジュールや、高速に処理を行うことを考えた作られたモジュールに、このような形式で配布されているものが多い

* Windows：Cコンパイラが必要

  * 一部の有名なモジュールでは、インストーラやコンパイル済みのライブラリ(DLL)が用意されている

    => これらは、コンパイラが無くても利用できる

* Linux：コンパイラを利用できることが多いので、モジュールをビルドできる

* MacOS：Xcodeと呼ばれる無償でできる開発環境をインストールすると、ビルドを行える



## モジュールを自動でインストールする

* `PyPI`に存在しなくて、`pip`でインストールできないモジュールであっても、環境さえ整えばインストールはそれほど難しくない

* Pythonには、モジュールのビルドとインストールのための共通の仕組みが用意されている

* モジュールは大抵、圧縮ファイルになっている

  * 圧縮ファイルをダウンロードして展開すると、大抵`setup.py`というPythonのスクリプトファイルが入っている

  * このスクリプトにコマンドを与えることで、ビルドとインストールが行える

  => 部分的にC言語で書いたモジュールでは、見つかりにくい

* モジュールのビルドは、以下のコマンドを打ち込むことでインストールする

```bash
$ python setup.py install
```



## モジュールの設置場所とPythonのバージョン

* Pythonでは、モジュールは1つのディレクトリにまとめて配置する

* 標準ライブラリ以外のサードパーティのライブラリは、「`site-packages`」というディレクトリに設置することになっている

* 「`setup.py`」は、自動的にモジュールを設置すべきディレクトリを割り出して、インストールを行う

* AnacondaをMacやLinuxの環境にインストールした場合、Anacondaの関連ファイルが、ユーザディレクトリ以下の`anaconda`という階層に、まとめられる

* ここから、「`lib/python3.5/site-packages`」という階層に外部モジュールが置かれる



| 版 |  年月日   |
|---|----------|
|初版|2019/02/02|
